# ===================================
# Base Kustomization
# ===================================
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# No namespace specified - NKP auto-creates and manages namespaces

# Common labels for all resources (using 'labels' instead of deprecated 'commonLabels')
labels:
  - pairs:
      app.kubernetes.io/name: realtime-poll
      app.kubernetes.io/managed-by: flux
    includeSelectors: false

# Resources to deploy
resources:
  # Core
  # Note: ConfigMap is generated by overlays via configMapGenerator
  - rbac.yaml
  
  # Security
  - network-policies.yaml
  - resource-quota.yaml
  - pdb.yaml
  
  # Components
  - redis
  - backend
  - frontend
  
  # Networking
  - ingress.yaml
  
  # Monitoring
  - servicemonitor.yaml
  
  # Note: external-secrets.yaml is included only in prod overlay
